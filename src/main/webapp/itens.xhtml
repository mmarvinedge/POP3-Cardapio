<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:b="http://bootsfaces.net/ui"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:panelGroup id="item" >
        <h:panelGroup rendered="#{actionMB.acao == 'itens'}" >
            <h:form   >
                <div class="row" style="padding: 5px;     margin-left: 0px; margin-right: 0px; border-bottom: 1px solid #ccc;">
                    <div class="col-xs-4 ">
                        <p:commandLink action="#{actionMB.setAcao('grupo')}"   style="color: #e83b62; "  >
                            <i class="fa fa-arrow-left fa-2x"></i>
                        </p:commandLink>
                    </div>
                    <div class="col-xs-8 text-right">
                        <strong style="font-size: 20px;color:#e83b62; ">#{orderMB.categorySelected.name}</strong>
                    </div>
                </div>
                <div class="row equal-cols row-flex" style="padding: 5px;     margin-left: 0px; margin-right: 0px; ">
                    <ui:repeat value="#{orderMB.products}" var="prod">

                        <div class="col-xs-12 containp5">
                            <p:commandLink action="#{orderMB.setProduct(prod)}" style="width: 100%;     border-bottom: 1px solid #ccc;" 
                                           update=":mdlPedir" oncomplete="openModal('mdlPedir')">
                                <div class="row">
                                    <div class="col-xs-4" style="padding: 0;">
                                        <div class="itm-img ima-#{prod.id}">
                                            <center>
                                                <img  role="presentation" src="#{prod.imageBase64}"  style="max-width: 116px; max-height: 104px;"/>
                                            </center>
                                        </div>
                                    </div>
                                    <div class="col-xs-8">
                                        <span style="color: #3e3e3e;font-weight: 400;font-size: 1.8rem;line-height: 1.25rem;margin-bottom: 9px;">#{prod.name}</span><br/>
                                        <span style="font-size: 1.00rem;line-height: 1.10rem;color: #717171;word-break: break-word;">#{prod.description}</span><Br/>
                                        <span style="font-size: 2rem;line-height: 1.25rem;font-weight: 400;color: #e83b62;">#{orderMB.formatarMoeda(prod.price)}</span>
                                    </div>
                                </div>
                            </p:commandLink>
                        </div>
                    </ui:repeat>
                </div>
            </h:form>


            <b:modal id="mdlPedir"  title="" styleClass="modalPseudoClass custom-modal fade-scale" size="modal-lg" headerClass="head-hidden" >
                <h:form id="frmModal" >



                    <div class="modal-header" style="    background-image: url('#{facesContext.externalContext.request.contextPath}/resources/img/back.jpg');     height: 205px;                     min-height: 205px;    background-size: 100%; background-repeat: none;  max-height: 250px;padding: 16px 32px;">
                        <button type="button" class="close" data-dismiss="modal" style=" background: white; border-radius: 32px;color: #337ab7;right:  15px;position: absolute;height: 55px;width: 55px;opacity: .7;font-size: 37px;">&times;</button>

                        <div class="" style="    position: absolute; top: 75px;     width: 94%;
                             background: rgba(255,255,255,0.7); padding: 10px;border-radius: 15px;left: 10px;height: 120px;     padding-top: 0px;">
                            <h3 class="" >#{orderMB.product.name}</h3>
                            <small >#{orderMB.product.description}</small>
                        </div>
                        

                    </div>


                    <div class="modal-body">
                        <h:panelGroup id="grp">

                            <div class="row" style="padding: 10px;">
                                <div class="col-xs-12">
                                    <ui:repeat value="#{orderMB.item.product.attributes}" var="at">
                                        <h:outputLabel for="grid" value="Adicionais" /><br/>
                                        <p:selectManyCheckbox id="grid" value="#{orderMB.adicionais}" layout="grid" columns="1" converter="Converter"
                                                              >
                                            <f:selectItems itemDisabled="true" value="#{at.values}" var="val" itemLabel="#{val.name} - (#{orderMB.formatarMoeda(val.price)})" itemValue="#{val}" />
                                            <p:ajax event="change" listener="#{orderMB.processarTotalAdicionais()}" update=":frmModal:grpValue" />
                                        </p:selectManyCheckbox>
                                    </ui:repeat>
                                </div>
                            </div>

                            <div class="row" style="padding: 10px;">
                                <div class="col-xs-12">
                                    <label>Recado</label>
                                    <b:inputTextarea rows="2" value="#{orderMB.item.obs}" />
                                </div>
                            </div>



                        </h:panelGroup>
                    </div>
                    <div class="modal-footer">
                        <h:panelGroup >
                            <p:remoteCommand name="complete" action="#{orderMB.change()}" />
                            <div class="row">
                                <div class="col-md-3 text-left">
                                    <strong>Quantidade</strong>
                                    <h5 style="position: absolute;right: 15px;top: -10px;font-size: 15px;font-weight: bolder;">#{orderMB.formatarMoeda(orderMB.product.price)}</h5>
                                    <b:touchSpin id="spin1"   min="1" max="50" step="1" value="#{orderMB.item.quantity}" style="text-align: center;     " 
                                                 style-class="ipt-touch"      oncomplete="complete()"  update="@form">
                                    </b:touchSpin>
                                    <p:blockUI block="spin1" widgetVar="loadingSpin"  >
                                        <i class="fa fa-circle-o-notch fa-spin fa-2x fa-fw"></i>
                                    </p:blockUI>
                                </div>

                                <div class="col-md-5">

                                </div>

                                <div class="col-md-4">
                                    <p:commandLink id="btnLinkAdd" styleClass="btn btn-primary btn-block text-right" action="#{orderMB.addCart()}" oncomplete="closeModal('mdlPedir');effect('ima-#{orderMB.product.id}')"  style="padding: 15px;     margin-top: 32px;"
                                                   update=":grpNumbers,:frmMySide">
                                        <div class="row">
                                            <div class="col-xs-5 text-left bold">
                                                <h:panelGroup id="grpValue">
                                                    <strong>
                                                        #{orderMB.formatarMoeda((orderMB.item.quantity * orderMB.item.price)+orderMB.item.totalAds)}
                                                    </strong>
                                                </h:panelGroup>

                                            </div>
                                            <div class="col-xs-7 text-right">
                                                <strong>Adicionar Item</strong>
                                            </div>
                                        </div>
                                    </p:commandLink>
                                </div>
                            </div>
                        </h:panelGroup>
                    </div>

                </h:form>
            </b:modal>
        </h:panelGroup>
    </h:panelGroup>
</html>

